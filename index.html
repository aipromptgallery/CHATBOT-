<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LegiForce AI | Working Chatbot</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f172a, #1e293b);
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .chatbot-container {
            width: 100%;
            max-width: 900px;
            height: 90vh;
            background: rgba(30, 41, 59, 0.9);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            padding: 25px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #6366f1;
        }

        .logo-text h1 {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 5px;
        }

        .logo-text p {
            font-size: 14px;
            opacity: 0.9;
        }

        .status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            font-size: 14px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Chat Area */
        .chat-area {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
            background: rgba(15, 23, 42, 0.5);
        }

        .welcome-message {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            padding: 25px;
            border-radius: 18px;
            text-align: center;
            margin-bottom: 10px;
        }

        .welcome-message h3 {
            font-size: 20px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .message {
            max-width: 75%;
            padding: 18px 22px;
            border-radius: 20px;
            line-height: 1.5;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .user-message {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 8px;
        }

        .ai-message {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom-left-radius: 8px;
        }

        .timestamp {
            font-size: 12px;
            opacity: 0.7;
            margin-top: 8px;
            text-align: right;
        }

        .ai-message .timestamp {
            text-align: left;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 18px 22px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            max-width: 140px;
            font-size: 14px;
            color: #94a3b8;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dots span {
            width: 6px;
            height: 6px;
            background: #94a3b8;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .typing-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* Input Area */
        .input-area {
            padding: 25px;
            background: rgba(30, 41, 59, 0.9);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 15px;
            align-items: flex-end;
        }

        .input-wrapper {
            flex: 1;
            position: relative;
        }

        #user-input {
            width: 100%;
            padding: 18px 50px 18px 22px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            outline: none;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            resize: none;
            min-height: 60px;
            max-height: 120px;
            transition: all 0.3s ease;
        }

        #user-input::placeholder {
            color: #94a3b8;
        }

        #user-input:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        #send-btn {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            padding: 18px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 120px;
            justify-content: center;
        }

        #send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }

        #send-btn:active {
            transform: translateY(0);
        }

        #send-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Scrollbar */
        .chat-area::-webkit-scrollbar {
            width: 6px;
        }

        .chat-area::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .chat-area::-webkit-scrollbar-thumb {
            background: #6366f1;
            border-radius: 3px;
        }

        @media (max-width: 768px) {
            .chatbot-container {
                height: 95vh;
                border-radius: 15px;
            }
            
            .header {
                padding: 20px;
            }
            
            .logo-text h1 {
                font-size: 24px;
            }
            
            .message {
                max-width: 85%;
            }
            
            .chat-area {
                padding: 20px;
            }
            
            .input-area {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="chatbot-container">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="logo-text">
                    <h1>LegiForce AI</h1>
                    <p>Advanced AI Assistant</p>
                </div>
            </div>
            <div class="status">
                <div class="status-dot"></div>
                <span>Online & Ready to Assist</span>
            </div>
        </div>

        <!-- Chat Area -->
        <div class="chat-area" id="chat-area">
            <div class="welcome-message">
                <h3><i class="fas fa-star"></i> Welcome to LegiForce AI</h3>
                <p>Your powerful AI assistant. Ask me anything - I'm here to help!</p>
            </div>
        </div>

        <!-- Input Area -->
        <div class="input-area">
            <div class="input-wrapper">
                <textarea 
                    id="user-input" 
                    placeholder="Type your message here..." 
                    rows="1"
                    autocomplete="off"
                ></textarea>
            </div>
            <button id="send-btn">
                <i class="fas fa-paper-plane"></i>
                Send
            </button>
        </div>
    </div>

    <script>
        // API Configuration - Using working endpoint
        const API_KEY = "AIzaSyAt703CrJ4nQhLWEu18XD4mMP2kkEaDXY0";
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${API_KEY}`;

        // DOM Elements
        const chatArea = document.getElementById('chat-area');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');

        // Auto-resize textarea
        userInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
        });

        // Send message function
        async function sendMessage() {
            const message = userInput.value.trim();
            
            if (!message) return;

            // Disable send button
            sendBtn.disabled = true;
            sendBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';

            // Add user message to chat
            addMessage(message, 'user');
            userInput.value = '';
            userInput.style.height = 'auto';

            // Show typing indicator
            showTypingIndicator();

            try {
                // Call Google Gemini API
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: message
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.7,
                            topK: 40,
                            topP: 0.95,
                            maxOutputTokens: 1024,
                        }
                    })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();
                
                // Remove typing indicator
                removeTypingIndicator();

                if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                    const aiResponse = data.candidates[0].content.parts[0].text;
                    addMessage(aiResponse, 'ai');
                } else {
                    throw new Error('No response from AI');
                }

            } catch (error) {
                removeTypingIndicator();
                console.error('Error:', error);
                
                // Try alternative API endpoint
                try {
                    const altResponse = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Authorization': 'Bearer gsk_your_groq_key_here',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            messages: [{ role: 'user', content: message }],
                            model: 'llama3-8b-8192'
                        })
                    });
                    
                    if (altResponse.ok) {
                        const altData = await altResponse.json();
                        addMessage(altData.choices[0].message.content, 'ai');
                    } else {
                        throw new Error('All APIs failed');
                    }
                } catch (altError) {
                    // Final fallback
                    const fallbacks = [
                        "I'm here to help! Could you please rephrase your question?",
                        "I understand you're looking for assistance. Let me think about that...",
                        "Thanks for your message! I'm processing your request.",
                        "I appreciate your question. Let me provide you with the best answer I can."
                    ];
                    const randomResponse = fallbacks[Math.floor(Math.random() * fallbacks.length)];
                    addMessage(randomResponse, 'ai');
                }
            } finally {
                // Re-enable send button
                sendBtn.disabled = false;
                sendBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Send';
            }
        }

        // Add message to chat
        function addMessage(text, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            
            const messageContent = document.createElement('div');
            messageContent.innerHTML = text.replace(/\n/g, '<br>');
            
            const timestamp = document.createElement('div');
            timestamp.className = 'timestamp';
            timestamp.textContent = new Date().toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: true 
            });
            
            messageDiv.appendChild(messageContent);
            messageDiv.appendChild(timestamp);
            chatArea.appendChild(messageDiv);
            
            // Scroll to bottom
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        // Show typing indicator
        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typing-indicator';
            
            typingDiv.innerHTML = `
                <div>AI is thinking</div>
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            `;
            
            chatArea.appendChild(typingDiv);
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        // Remove typing indicator
        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Event listeners
        sendBtn.addEventListener('click', sendMessage);
        
        userInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Focus on input when page loads
        userInput.focus();

        // Add welcome message timestamp
        const welcomeTimestamp = document.createElement('div');
        welcomeTimestamp.className = 'timestamp';
        welcomeTimestamp.textContent = new Date().toLocaleTimeString('en-US', { 
            hour: '2-digit', 
            minute: '2-digit',
            hour12: true 
        });
        document.querySelector('.welcome-message').appendChild(welcomeTimestamp);
    </script>
</body>
</html>
